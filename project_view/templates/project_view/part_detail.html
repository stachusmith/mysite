{% extends "base_menu.html" %}
{% load humanize %}
{% load static %}


{% block content %}
<link id="stylesheet" rel="stylesheet" type="text/css" href="{% static 'project_view/part.css' %}">
<span style="float: right;">
({{ part.updated_at|naturaltime }})
{% if part.owner == user %}
<a href="{% url 'project_view:part_update' module.id part.id %}"><i class="fa fa-pencil"></i></a>
<a href="{% url 'project_view:part_delete' module.id part.id %}"><i class="fa fa-trash"></i></a>
{% endif %}
</span>

<h1>{{ part.name }}</h1>
<p>
  <a href="{% url 'project_view:module_detail' module.id project.id %}">back to all parts</a>
</p>
<div class='part_container'>
  <div class='part_properties'>
    <p>
    description: {{ part.description }}
    </p>
    <p>
    OEM: {{ part.module.project.client }}
    </p>
    <p>
    project: {{ part.module.project }}
    </p>
    <p>
    module: {{ part.module }}
    </p>
    <p>
    supplier: {{ part.supplier }}
    </p>
    <p>
    thickness: {{ part.thickness }}mm
    </p>
  </div>
  <div class='fixing_container'>
    <p>
    fixing combinations:
        {% if fixes %}
        <ul>
          {% for fix in fixes %}
            <li>
                {{ fix.number_of_elements }} {{ fix.fixing.name }}s
            </li>
          {% endfor %}
        </ul>
        {% else %}
          <p>There are no fixing combinations in the database.</p>
        {% endif %}
        <p>
          <a href="{% url 'project_view:fix_create' part.id %}">add new combination</a>
        </p>
        <p>
          <a href="{% url 'project_view:fixing_create' %}">create new fixing elements</a>
        </p>
    </p>
  </div>
</div>


<div class="topics_container">
  <input type="submit" style='float: right;' href="{% url 'project_view:topic_create' part.id %}" value="Create new topic..."></input>
  <input id="normal_view" type="submit" href="#" style='float: right; margin-right: 5px;'
    onclick="document.getElementById('stylesheet').href = '{% static 'project_view/part_print.css' %}'; //change css file for print view
              document.getElementById('print_view').hidden=false; //hide button for print
              document.getElementById('normal_view').hidden=true; /*show button for normal view*/" value="Print protocol view"></input>



  <input id="print_view" type="submit" href="#" hidden style='float: right; margin-right: 5px;'
  onclick="document.getElementById('stylesheet').href = '{% static 'project_view/part.css' %}'; //change css file for normal view
            document.getElementById('normal_view').hidden=false; //hide button for print
            document.getElementById('print_view').hidden=true; /*show button for normal view*/" value="Compressed view"></input>






  <h4>new topics:</h4>
  {% if new_topics_list %}
    
    {% for topic in new_topics_list %}
      <div id="topic">
        <div class="topic_left">
          <div class="icon"><i class="fas fa-exclamation" style="font-size:20px;color:orange"></i></div>
          <div class="topic_title_prot">
            {{ topic.title }}
          </div>
        </div>
        <div class="topic_middle">
            <div class="topic_title">
              <a href="{% url 'project_view:topic_detail' part.id topic.id %}">{{ topic.title }}</a>
            </div>
            <div class="entry_container">
              {% if topic.entry_list %}
                  {% for entry in topic.entry_list %}
                  <div class="entry">
                      <div class="entry_date">
                      {{ entry.date_of_entry }}
                      </div>
                      <div class="entry_solution">
                      {{ entry.solution }}
                      </div>
                  </div>
                  {% endfor %}
              {% else %}
                  there are no entries for this topic
              {% endif %}
            </div>
        </div>
        <div class="topic_right">
            <div class="pic_list">
              {% if topic.pic_list %}
                  {% for picture in topic.pic_list %}
                      <img class="pic" type="image" src="{% url 'project_view:picture_stream' topic.id picture.id %}">
                  {% endfor %}
                  {% else %}
                  <img src="{% static 'project_view/my_block.png' %}"
                      style="width: 100px; height: 100px;" alt="no pictures in database">
              {% endif %}
            </div>
            <div class="edit_delete_icons">
              {% if part.owner == user %}
                  <a href="{% url 'project_view:topic_update' part.id topic.id %}"><i class="fa fa-pencil"></i></a>
                  <a href="{% url 'project_view:topic_delete' part.id topic.id %}"><i class="fa fa-trash"></i></a>
              {% endif %}
            </div>
        </div>
      </div>
  {% endfor %}
  {% else %}
  <p>
      There are no new topics in the database.
  </p>
  {% endif %}




  <h4>topics in process:</h4>
  {% if in_process_topics_list %}
    {% for topic in in_process_topics_list %}
    <div id="topic">
      <div class="topic_left">
        <div class="icon"><i class="fa fa-cog fa-spin" style="font-size:20px"></i></div>
        <div class="topic_title_prot">
          {{ topic.title }}
        </div>
      </div>
      <div class="topic_middle">
          <div class="topic_title">
          <a href="{% url 'project_view:topic_detail' part.id topic.id %}">{{ topic.title }}</a>
          </div>
          <div class="entry_container">
            {% if topic.entry_list %}
                {% for entry in topic.entry_list %}
                  <div class="entry">
                      <div class="entry_date">
                        {{ entry.date_of_entry }}
                      </div>
                      <div class="entry_solution">
                        {{ entry.solution }}
                      </div>
                  </div>
                {% endfor %}
            {% else %}
                there are no entries for this topic
            {% endif %}
          </div>
      </div>
      <div class="topic_right">
          <div class="pic_list">
            {% if topic.pic_list %}
                {% for picture in topic.pic_list %}
                    <img class="pic" type="image" src="{% url 'project_view:picture_stream' topic.id picture.id %}">
                {% endfor %}
                {% else %}
                  <img src="{% static 'project_view/my_block.png' %}"
                      style="width: 100px; height: 100px;" alt="no pictures in database">
            {% endif %}
          </div>
          <div class="edit_delete_icons">
            {% if part.owner == user %}
                <a href="{% url 'project_view:topic_update' part.id topic.id %}"><i class="fa fa-pencil"></i></a>
                <a href="{% url 'project_view:topic_delete' part.id topic.id %}"><i class="fa fa-trash"></i></a>
            {% endif %}
          </div>
      </div>
    </div>
  {% endfor %}
{% else %}
<p>
  There are no "in process" topics in the database.
</p>
{% endif %}



















  <h4>settled topics:</h4>
  {% if settled_topics_list %}
    
    {% for topic in settled_topics_list %}
      <div id="topic">
        <div class="topic_left">
          <div class="icon"><i class='fas fa-check-circle' style='font-size:20px;color:green'></i></div>
          <div class="topic_title_prot">
            {{ topic.title }}
          </div>
        </div>
        <div class="topic_middle">
          <div class="topic_title">
            <a href="{% url 'project_view:topic_detail' part.id topic.id %}">{{ topic.title }}</a>
          </div>
          <div class="entry_container">
            {% if topic.entry_list %}
              {% for entry in topic.entry_list %}
                <div class="entry">
                  <div class="entry_date">
                    {{ entry.date_of_entry }}
                  </div>
                  <div class="entry_solution">
                    {{ entry.solution }}
                  </div>
                </div>
              {% endfor %}
            {% else %}
              there are no entries for this topic
            {% endif %}
          </div>
        </div>
        <div class="topic_right">
          <div class="pic_list">
            {% if topic.pic_list %}
                {% for picture in topic.pic_list %}
                  <img class="pic" type="image" src="{% url 'project_view:picture_stream' topic.id picture.id %}">
                {% endfor %}
              {% else %}
                <img src="{% static 'project_view/my_block.png' %}"
                  style="width: 100px; height: 100px;" alt="no pictures in database">
            {% endif %}
          </div>
          <div class="edit_delete_icons">
            {% if part.owner == user %}
              <a href="{% url 'project_view:topic_update' part.id topic.id %}"><i class="fa fa-pencil"></i></a>
              <a href="{% url 'project_view:topic_delete' part.id topic.id %}"><i class="fa fa-trash"></i></a>
            {% endif %}
          </div>
        </div>
      </div>
    {% endfor %}
  {% else %}
    <p>
      There are no settled topics in the database.
    </p>
  {% endif %}
</div>


{% endblock %}

